<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AquaTag</title>

<style>
body{margin:0;font-family:Arial;background:#f2fbff}
header{padding:15px;background:white}
.loginbtn{float:right;background:#02025c;color:white;border:none;padding:10px 20px;border-radius:20px;cursor:pointer}

.hero{height:250px;background:linear-gradient(90deg,#7b82dd,#9de0f2);display:flex;align-items:center;justify-content:center;color:white;font-size:32px}

.box{background:white;padding:25px;border-radius:12px;width:320px}
.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center}

input{width:100%;padding:10px;margin:8px 0}
button{width:100%;padding:10px;margin-top:10px;border:none;border-radius:8px;background:#02025c;color:white}

.red{color:red;text-align:center}
.green{color:green;text-align:center}

.footer{background:#02025c;color:white;text-align:center;padding:10px}
</style>
</head>

<body>

<header>
AquaTag
<button class="loginbtn" onclick="openLogin()">Customer Login</button>
</header>

<div class="hero">Your Brand. Our Water.</div>

<div class="footer">AquaTag India – contact.aquatag@gmail.com – 9961835925</div>

<!-- LOGIN -->
<div id="loginModal" class="overlay">
<div class="box">
<h3>Login</h3>
<input id="loginEmail" placeholder="Email">
<input id="loginPass" type="password" placeholder="Password">
<div id="loginMsg" class="red"></div>
<button onclick="login()">Login</button>
<button onclick="googleLogin()">Login with Google</button>
<p onclick="openSignup()" style="text-align:center;cursor:pointer">Create Account</p>
<button style="background:red" onclick="closeAll()">Close</button>
</div>
</div>

<!-- SIGNUP -->
<div id="signupModal" class="overlay">
<div class="box">
<h3>Create Account</h3>
<input id="signEmail" placeholder="Email">
<input id="signPass" type="password" placeholder="Password">
<div id="signMsg" class="green"></div>
<button onclick="register()">Register</button>
<button onclick="closeAll()">Close</button>
</div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
getAuth,
signInWithEmailAndPassword,
createUserWithEmailAndPassword,
GoogleAuthProvider,
signInWithPopup,
onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import {
getFirestore,
doc,setDoc,getDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyDqhSH9crtmW5iEA-hsFudxHng4pZw860g",
authDomain: "aquatag-ef3cd.firebaseapp.com",
projectId: "aquatag-ef3cd",
storageBucket: "aquatag-ef3cd.appspot.com",
messagingSenderId: "93922635895",
appId: "1:93922635895:web:ab716bac5c204bd69a9672"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const ADMIN="contact.aquatag@gmail.com";

window.openLogin=()=>loginModal.style.display="flex";
window.openSignup=()=>{loginModal.style.display="none";signupModal.style.display="flex";}
window.closeAll=()=>{loginModal.style.display="none";signupModal.style.display="none";}

window.register=async()=>{
const e=signEmail.value;
const p=signPass.value;

const u=await createUserWithEmailAndPassword(auth,e,p);

await setDoc(doc(db,"users",u.user.uid),{
email:e,
approved:false
});

signMsg.innerHTML="Account created. Waiting for admin approval.";
}

window.login=async()=>{
try{
const e=loginEmail.value;
const p=loginPass.value;
const u=await signInWithEmailAndPassword(auth,e,p);

if(e===ADMIN){location="admin.html";return;}

const snap=await getDoc(doc(db,"users",u.user.uid));
if(!snap.data().approved){
loginMsg.innerHTML="Waiting for admin approval";
return;
}

location="myorders.html";

}catch(err){
loginMsg.innerHTML=err.message;
}
}

window.googleLogin=async()=>{
const prov=new GoogleAuthProvider();
const u=await signInWithPopup(auth,prov);

await setDoc(doc(db,"users",u.user.uid),{
email:u.user.email,
approved:false
},{merge:true});

alert("Waiting for admin approval");
}

onAuthStateChanged(auth,u=>{
if(!u)return;
if(u.email===ADMIN)location="admin.html";
});

</script>

</body>
</html>
