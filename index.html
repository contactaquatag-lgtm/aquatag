<!DOCTYPE html>
<html>
<head>
<title>AquaTag</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}
body{background:#f2f9ff}

nav{background:#fff;padding:15px 50px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 10px rgba(0,0,0,.05)}
.btn{background:#03045e;color:#fff;padding:8px 18px;border-radius:20px;cursor:pointer}

.hero{height:260px;background:linear-gradient(135deg,#6b6fd6,#9ee7f5);display:flex;align-items:center;justify-content:center;color:white;font-size:34px;font-weight:700}

.section{padding:50px;text-align:center}
.cards{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:25px}
.card{background:white;padding:22px;border-radius:12px;box-shadow:0 0 15px rgba(0,0,0,.05)}

.page{display:none}
.dashboard{max-width:900px;margin:30px auto}

.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6)}
.box{background:white;width:360px;margin:120px auto;padding:25px;border-radius:12px;text-align:center}

input,select{width:100%;padding:10px;margin:6px 0}
button{width:100%;padding:10px;background:#03045e;color:white;border:none;border-radius:6px;margin-top:8px}

.red{color:red;font-size:13px}
.green{color:green;font-size:13px}

.order{background:white;padding:15px;border-radius:10px;margin:10px 0}

footer{background:#03045e;color:white;text-align:center;padding:25px;margin-top:40px}
</style>
</head>

<body>

<nav>
<b>AquaTag</b>
<div class="btn" onclick="openLogin()">Customer Login</div>
</nav>

<!-- HOME -->
<div id="home" class="page">
<div class="hero">Your Brand. Our Water.</div>

<div class="section">
<h2>Why AquaTag?</h2>
<div class="cards">
<div class="card">Pure Quality</div>
<div class="card">Custom Branding</div>
<div class="card">Bulk Supply</div>
</div>
</div>

<div class="section">
<h2>Our Services</h2>
<div class="cards">
<div class="card">250ml / 500ml / 1L / 2L</div>
<div class="card">Custom Sticker Printing</div>
<div class="card">Office & Event Supply</div>
</div>
</div>
</div>

<!-- CUSTOMER DASHBOARD -->
<div id="dashboard" class="page dashboard">
<h2>Place New Order</h2>

<input id="q250" placeholder="250ml Quantity">
<input id="q500" placeholder="500ml Quantity">
<input id="q1" placeholder="1L Quantity">
<input id="q2" placeholder="2L Quantity">

<button onclick="placeOrder()">Submit Order</button>

<h3 style="margin-top:20px">My Orders</h3>
<div id="myOrders"></div>

<button onclick="logout()">Logout</button>
</div>

<!-- PENDING -->
<div id="pending" class="page dashboard">
<h2>Your account is waiting for admin approval ⏳</h2>
<button onclick="logout()">Logout</button>
</div>

<!-- ADMIN -->
<div id="admin" class="page dashboard">
<h2>Admin Panel</h2>

<h3>Pending Users</h3>
<div id="users"></div>

<h3 style="margin-top:25px">Orders</h3>
<div id="allOrders"></div>

<button onclick="logout()">Logout</button>
</div>

<footer>
AquaTag India — contact.aquatag@gmail.com — 9961835925
</footer>

<!-- LOGIN -->
<div id="loginModal" class="modal">
<div class="box">
<h3>Login</h3>
<input id="le" placeholder="Email">
<input id="lp" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<p onclick="openSignup()" style="color:blue;cursor:pointer">Create Account</p>
<div id="loginErr" class="red"></div>
<button onclick="closeLogin()">Close</button>
</div>
</div>

<!-- SIGNUP -->
<div id="signupModal" class="modal">
<div class="box">
<h3>Create Account</h3>
<input id="se" placeholder="Email">
<input id="sp" type="password" placeholder="Password">
<button onclick="signup()">Register</button>
<div id="signupMsg" class="green"></div>
<div id="signupErr" class="red"></div>
<button onclick="closeSignup()">Close</button>
</div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyDqhSH9crtmW5iEA-hsFudxHng4pZw860g",
 authDomain:"aquatag-ef3cd.firebaseapp.com",
 projectId:"aquatag-ef3cd"
});

const auth=firebase.auth();
const db=firebase.firestore();
const ADMIN_EMAIL="contact.aquatag@gmail.com";

function show(x){
document.querySelectorAll(".page").forEach(p=>p.style.display="none");
document.getElementById(x).style.display="block";
}
show("home");

/* UI */
function openLogin(){loginModal.style.display="block"}
function closeLogin(){loginModal.style.display="none"}
function openSignup(){closeLogin();signupModal.style.display="block"}
function closeSignup(){signupModal.style.display="none"}

/* SIGNUP */
function signup(){
signupErr.innerText=""; signupMsg.innerText="";
auth.createUserWithEmailAndPassword(se.value,sp.value).then(c=>{
db.collection("users").doc(c.user.uid).set({email:se.value,status:"pending"});
signupMsg.innerText="Account created. Waiting for admin approval.";
});
}

/* LOGIN */
function login(){
loginErr.innerText="";
auth.signInWithEmailAndPassword(le.value,lp.value).then(c=>{
closeLogin();
if(c.user.email===ADMIN_EMAIL){loadAdmin();return;}
db.collection("users").doc(c.user.uid).get().then(d=>{
if(d.data().status==="pending"){show("pending");}
else{show("dashboard");loadMyOrders();}
});
}).catch(e=>loginErr.innerText=e.message);
}

/* LOGOUT */
function logout(){auth.signOut();show("home");}

/* ADMIN */
function loadAdmin(){
show("admin");
db.collection("users").onSnapshot(s=>{
users.innerHTML="";
s.forEach(d=>{
if(d.data().status==="pending"){
users.innerHTML+=`<div class="order">${d.data().email}
<button onclick="approve('${d.id}')">Approve</button></div>`;
}
});
});

db.collection("orders").onSnapshot(s=>{
allOrders.innerHTML="";
s.forEach(o=>{
allOrders.innerHTML+=`
<div class="order">
<b>${o.data().email}</b><br>
250:${o.data().q250} | 500:${o.data().q500} | 1L:${o.data().q1} | 2L:${o.data().q2}<br>
<select onchange="updateStatus('${o.id}',this.value)">
<option>${o.data().status}</option>
<option>Printing</option>
<option>Packed</option>
<option>Delivered</option>
</select>
</div>`;
});
});
}

function approve(id){
db.collection("users").doc(id).update({status:"approved"});
}

/* CUSTOMER ORDERS */
function placeOrder(){
auth.onAuthStateChanged(u=>{
if(!u)return;
db.collection("orders").add({
uid:u.uid,
email:u.email,
q250:q250.value||0,
q500:q500.value||0,
q1:q1.value||0,
q2:q2.value||0,
status:"Pending"
});
});
}

function loadMyOrders(){
auth.onAuthStateChanged(u=>{
db.collection("orders").where("uid","==",u.uid)
.onSnapshot(s=>{
myOrders.innerHTML="";
s.forEach(o=>{
myOrders.innerHTML+=`
<div class="order">
Order Status: ${o.data().status}<br>
250:${o.data().q250} | 500:${o.data().q500} | 1L:${o.data().q1} | 2L:${o.data().q2}
</div>`;
});
});
}

function updateStatus(id,val){
db.collection("orders").doc(id).update({status:val});
}
</script>

</body>
</html>
